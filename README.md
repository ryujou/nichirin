# Nichirin V2

<p align="center">
  <img src="assets/peacock.jpg" alt="Peacock hardware photo" width="560">
</p>

<p align="center">
  <a href="https://space.bilibili.com/3546647883680530"><img src="https://img.shields.io/badge/Author-%E6%81%A9%E5%B8%88-2B90D9?style=flat-square" alt="author"></a>
  <img src="https://img.shields.io/badge/MCU-STM32G030xx-0F6FC6?style=flat-square" alt="mcu">
  <img src="https://img.shields.io/badge/Language-C11-3F6EA5?style=flat-square" alt="language">
  <img src="https://img.shields.io/badge/Build-CMake-064F8C?style=flat-square" alt="cmake">
  <img src="https://img.shields.io/badge/Status-Active-1EAE98?style=flat-square" alt="status">
</p>

<p align="center">??? V4.0??? <a href="https://space.bilibili.com/3546647883680530">?????????</a></p>

> STM32G030xx ????? STM32CubeMX ????? CMake ???12 ? LED I2C ?????????????

## ??

- [????](#????)
- [????](#????)
- [???????](#???????)
- [?????](#?????)
- [????](#????)
- [?????](#?????)
- [????](#????)
- [???? CubeMX ??](#????-cubemx-??)
- [????](#????)

## ????

Nichirin V2 ??? STM32G030 ? 12 ? LED ????????? TLC59116 I2C ????????????? A/B + ????????????????? Flash ?????

## ????

- TLC59116 12 ??? PWM ?? (8-bit)
- 9 ????????/??/??/??/?????
- ????????????????????
- ?? 0..255 ????
- ???? Flash ?????????

## ???????

- **LED ??**: TLC59116 I2C??? A0=GND??? 7-bit ?? `0x60`
- **I2C ??**: SCL=PB3?SDA=PB7??? CubeMX ????
- **???**: A=PA0?B=PA1?K=PA2?????
- **??**: SysTick 1ms ????????? 10ms ????

## ?????

| ?? | ?? | ?? |
| --- | --- | --- |
| CMake | 3.22+ | ???? |
| Ninja | ??? | ?? |
| ARM GNU Toolchain | `arm-none-eabi-gcc` | ?? PATH ? |
| STM32CubeMX | ?? | ?????? |

## ????

### 1. ??????Debug?

```sh
cmake --preset Debug
cmake --build --preset Debug
```

### 2. Release ??

```sh
cmake --preset Release
cmake --build --preset Release
```

### 3. ??????

```sh
cmake --build --preset Debug --target clean
```

### 4. ????

- `build/Debug/nichirin_V2.elf`
- `build/Debug/nichirin_V2.map`

## ?????

| ?? | ???? | ???? |
| --- | --- | --- |
| 1 | ?????? | ???? |
| 2 | ?????? | ???? |
| 3 | ?????? | ???? |
| 4 | ?????????? | ???? |
| 5 | ?????? | ???? |
| 6 | ???? | ???? |
| 7 | ??/???? | ???? |
| 8 | ?? | ?? |
| 9 | ???? | ???? |

### ????

????? 0~255???????????/???

???
- ?? 1~6 ??????????
- ?? 7 ??????????
- ?? 8 ??????????
- ?? 9 ??????????

???????????????
- ?????????
- ?????/??????
- ????????????????

?????????????????????????? Flash?

## ????

```
nichirin_V2/
??? Core/                    # ???? (main, app, drivers)
??? Drivers/                 # CMSIS ? HAL ??
??? cmake/                   # ???? CubeMX CMake ??
??? assets/                  # ?????
??? startup_stm32g030xx.s    # ????
??? STM32G030XX_FLASH.ld     # ????
??? nichirin_V2.ioc          # CubeMX ????
```

## ???? CubeMX ??

1. ?? STM32CubeMX ?? `nichirin_V2.ioc`
2. ????????? CMake/Makefile ?????
3. ?? [????](#????) ????

## ????

**Q: ?????????????**  
A: ????? ARM GNU Toolchain??? `arm-none-eabi-gcc` ?? PATH?

**Q: I2C ?????**  
A: ? CubeMX ??? I2C1 SCL=PB3?SDA=PB7???????

**Q: ???????**  
A: ?? A/B ????? `Core/Src/drivers/encoder.c` ????
